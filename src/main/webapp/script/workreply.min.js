/*
 * 生成题目的工作流程
 * 每出现一道题，为其生成一个rpl_no，然后根据类型创建该题的div在网页上进行显示
 * */function setExercise(e,t,n){return $.getJSON("ei/getExs?esId="+e,function(r){$("#exNo").text(e),$("#exFounder").text(t),$("#exCTime").text(n),$.each(r,function(e,t){var n=t.type;if(n!=null&&n!=""&&n=="selection"){$.TplPlus();var r=selectionTpl;r=r.replace(/tpl/g,COUNTER).replace(/@idx@/,COUNTER).replace(/@ctn@/g,t.selCtn).replace(/@br@/g,"<br>").replace(/@hr@/g,"<hr>"),$("#daTit").append(r)}else if(n!=null&&n!=""&&n=="judge"){$.TplPlus();var r=judgeTpl;r=r.replace(/tpl/g,COUNTER).replace(/@idx@/,COUNTER).replace(/@ctn@/g,t.jugCtn).replace(/@br@/g,"<br>").replace(/@hr@/g,"<hr>"),$("#daTit").append(r)}else if(n!=null&&n!=""&&n=="completion"){$.TplPlus();var r=completionTpl,i=completionSpaceTpl;i=i.replace(/tpl/g,COUNTER),r=r.replace(/tpl/g,COUNTER).replace(/@idx@/,COUNTER).replace(/@ctn@/g,t.cplCtn).replace(/@br@/g,"<br>").replace(/@hr@/g,"<hr>").replace(/@space@/g,i),$("#daTit").append(r)}else if(n!=null&&n!=""&&n=="question"){$.TplPlus();var r=questionTpl;r=r.replace(/tpl/g,COUNTER).replace(/@idx@/,COUNTER).replace(/@ctn@/g,t.qesCtn).replace(/@br@/g,"<br>").replace(/@hr@/g,"<hr>"),$("#daTit").append(r)}$(".sel-opt-"+COUNTER).click(function(){var e=$(this).attr("id")+"-ed",t=$(this).attr("id").match(/[\d]+/),n="";e.indexOf("a")>0?n="a":e.indexOf("b")>0?n="b":e.indexOf("c")>0?n="c":e.indexOf("d")>0?n="d":msgerror("严重错误！系统无法获取你点击的选项！"),$("#sel-"+t+"-val").val(n),$(".sel-"+t+"-ed").removeClass("sel-sb-opt-ed"),$("#"+e).addClass("sel-sb-opt-ed")}),$(".jug-"+COUNTER+"-opt").click(function(){var e=$(this).attr("id").match(/[\d]+/),t=$(this).attr("id")+"-ed",n="0";t.indexOf("a")>0?n="1":t.indexOf("b")>0?n="2":msgerror("严重错误！系统无法获取你的判断结果！"),$("#jug-"+e+"-val").val(n),$(".jug-"+e+"-ed").removeClass("sel-sb-opt-ed"),$("#"+t).addClass("sel-sb-opt-ed")})}),$("#daTit").css("display","block")}),!0}function getSelRplAns(e){return $("#sel-"+e+"-val").val()}function getAnsRplAns(e){return $("#ans-"+e+"-val").val()}function getJugRplAns(e){return $("#jug-"+e+"-val").val()}function getCplRplAns(e){var t="[";return $(".cpl-tpl-vals").each(function(){t+='"'+$(this).val()+'",'}),t=t.substring(0,t.length-1),t+="]",t}$("document").ready(function(){var e="tpl",t="select";$(".sel-opt-"+e).click(function(){var t=$(this).attr("id")+"-ed",n="";t.indexOf("a")>0?n="a":t.indexOf("b")>0?n="b":t.indexOf("c")>0?n="c":t.indexOf("d")>0?n="d":msgerror("严重错误！系统无法获取你点击的选项！"),$("#sel-"+e+"-val").val(n),$(".sel-"+e+"-ed").removeClass("sel-sb-opt-ed"),$("#"+t).addClass("sel-sb-opt-ed")}),$(".jug-"+e+"-opt").click(function(){var t=$(this).attr("id")+"-ed",n="0";t.indexOf("a")>0?n="1":t.indexOf("b")>0?n="2":msgerror("严重错误！系统无法获取你的判断结果！"),$("#jug-"+e+"-val").val(n),$(".jug-"+e+"-ed").removeClass("sel-sb-opt-ed"),$("#"+t).addClass("sel-sb-opt-ed")});var n="ei/getExss?sid="+$("#sid").text();$.getJSON(n,function(e){$.each(e,function(e,t){var n='<tr><td style="width:10%;">@NO@</td><td style="width:30%;"><a href="#">@HOLD@</a></td><td style="width:45%;">@TI@</td><td style="width:15%;"><a href="#question_begin" onclick="return setExercise(@esId@,@HOLD@,@TI@);" class="beginAnswer" id="ba-@esId@">开始答题</a></td></tr>';n=n.replace(/@HOLD@/g,t.founder).replace(/@TI@/g,t.cdate).replace(/@NO@/,e+1).replace(/@esId@/g,t.esId),$("#exList").append(n),e==0&&setExercise(t.esId,t.founder,t.cdate)})})});var selectionTpl='    <div class="mainbox container replyItem" id="sel-tpl">    	<h3 class="itemCount divInfo" id="itemCount-tpl">第@idx@题</h3>        <div class="single_question_answer">            <div class="single_question" id="selQes-tpl">@ctn@</div>        </div>        <div class="sel-select-box">        	<input type="hidden" name="sel-tpl-val" value="" id="sel-tpl-val" />			<div class="sel-sb-opt sel-sb-a sel-opt-tpl pullleft" id="sel-a-tpl">A<div class="sel-tpl-ed" id="sel-a-tpl-ed"></div></div>			<div class="sel-sb-opt sel-sb-b sel-opt-tpl pullleft" id="sel-b-tpl">B<div class="sel-tpl-ed" id="sel-b-tpl-ed"></div></div>			<div class="sel-sb-opt sel-sb-c sel-opt-tpl pullleft" id="sel-c-tpl">C<div class="sel-tpl-ed" id="sel-c-tpl-ed"></div></div>			<div class="sel-sb-opt sel-sb-d sel-opt-tpl pullleft" id="sel-d-tpl">D<div class="sel-tpl-ed" id="sel-d-tpl-ed"></div></div>			<div class="clearboth"></div>        </div>    </div>',questionTpl='    <div class="mainbox container replyItem" id="ans-tpl">    	<h3 class="itemCount divInfo" id="itemCount-tpl">第@idx@题</h3>        <div class="answer_question">            <div class="a_question" id="ans-tpl">@ctn@</div>            <div class="inputArea">                <div class="a_txt">答：</div>                <textarea rows="10" cols="131" class="a_answer inputField sslote" name="answer1" id="ans-tpl-val" ></textarea>            </div>        </div>    </div>',judgeTpl='    <div class="mainbox container replyItem" id="jug-tpl">    	<h3 class="itemCount divInfo" id="itemCount-tpl">第@idx@题</h3>        <div class="judge_question">            <div class="j_question">@ctn@</div>        </div>        <div class="j_answer_box">        	<input type="hidden" name="jug-tpl-val" value="" id="jug-tpl-val" />			<div class="j_true j_answer jug-tpl-opt pullleft" id="jug-tpl-opt-a">√<div class="jug-tpl-ed" id="jug-tpl-opt-a-ed"></div></div>			<div class="j_false j_answer jug-tpl-opt pullleft" id="jug-tpl-opt-b">x<div class="jug-tpl-ed" id="jug-tpl-opt-b-ed"></div></div>			<div class="clearboth"></div>        </div>    </div>',completionTpl='    <div class="mainbox container replyItem" id="cpl-tpl" >    	<h3 class="itemCount divInfo" id="itemCount-tpl">第@idx@题</h3>        <div class="fill_vacant_question">            <div class="fv_question" id="cpl-ctn-tpl">@ctn@</div>        </div>    </div>',completionSpaceTpl='<input type="text" name="fv_answer" class="fv_input cpl-tpl-vals" />',COUNTER=0;$.extend({TplPlus:function(){COUNTER++}});